<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Enigma de Conexão</title>

<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;700&display=swap" rel="stylesheet">

<style>
* { margin: 0; padding: 0; box-sizing: border-box; }

html, body {
    height: 100%;
    font-family: 'Montserrat', sans-serif;
    overflow: hidden;
    background: black;
}

/* --- INTRODUÇÃO (NOVO) --- */
#intro-overlay {
    position: fixed;
    inset: 0;
    background: black;
    z-index: 100;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    text-align: center;
    color: white;
    padding: 30px;
}

.intro-line {
    font-size: 1.3rem;
    line-height: 1.6;
    max-width: 600px;
    opacity: 0;
    transition: opacity 1s ease;
    position: absolute; /* Para ficarem no mesmo lugar */
}

#start-fragment-btn {
    margin-top: 20px;
    padding: 12px 35px;
    border: 1px solid rgba(255,255,255,0.6);
    background: transparent;
    color: white;
    border-radius: 30px;
    font-size: 1rem;
    cursor: pointer;
    opacity: 0;
    transition: opacity 1s;
    display: none;
    z-index: 110;
}

/* --- JOGO PRINCIPAL --- */
#background-container {
    position: fixed;
    inset: 0;
    background: url('image_10.png') no-repeat center center;
    background-size: cover;
    z-index: 0;
    transition: all 2s ease;
    opacity: 0; /* Começa invisível */
}

body.final-state #background-container {
    filter: brightness(0.25) blur(4px);
    transform: scale(1.05);
}

.main-content {
    position: relative;
    z-index: 20;
    height: 100vh;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    text-align: center;
    padding: 25px;
    color: white;
    transition: opacity 1s ease;
    opacity: 0; /* Começa invisível */
    pointer-events: none;
}

h1 {
    font-size: 2.2rem;
    margin-bottom: 30px;
    text-shadow: 0 4px 15px rgba(0,0,0,0.8);
}

.input-group {
    display: flex;
    gap: 10px;
    padding: 10px;
    border-radius: 40px;
    background: rgba(255,255,255,0.12);
    backdrop-filter: blur(10px);
}

input {
    padding: 12px 20px;
    border-radius: 30px;
    border: none;
    font-size: 1rem;
    outline: none;
}

button.check-btn {
    padding: 12px 28px;
    border-radius: 30px;
    border: none;
    cursor: pointer;
    font-weight: bold;
    background: #6a5acd;
    color: white;
}

#feedback {
    margin-top: 20px;
    opacity: 0;
    transition: opacity 0.5s;
    text-shadow: 0 2px 4px rgba(0,0,0,0.8);
}

/* --- FINAL --- */
#final-sequence {
    position: fixed;
    inset: 0;
    z-index: 50;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    text-align: center;
    pointer-events: none;
}

.final-text {
    font-size: 1.6rem;
    color: white;
    opacity: 0;
    transition: opacity 1.5s;
    margin-bottom: 30px;
}

.digit-container {
    opacity: 0;
    transition: opacity 1.5s;
    display: flex;
    flex-direction: column;
    align-items: center;
}

.unlock-label {
    font-size: 0.8rem;
    letter-spacing: 4px;
    color: #aaa;
    margin-bottom: 10px;
}

.the-number {
    font-size: 7rem;
    font-weight: 300;
    color: white;
}

#next-btn {
    margin-top: 35px;
    padding: 14px 38px;
    border-radius: 30px;
    border: 1px solid white;
    background: transparent;
    color: white;
    cursor: pointer;
    opacity: 0;
    transition: opacity 1.5s, background 0.3s;
    pointer-events: auto;
}

#next-btn:hover {
    background: rgba(255,255,255,0.15);
}
</style>
</head>

<body>

<audio id="success-sound" src="lock-correct.mp3"></audio>

<div id="intro-overlay">
    <p class="intro-line" id="line1">O começo no Senai foi apenas o primeiro passo.</p>
    <p class="intro-line" id="line2">Mas a nossa amizade ganhou vida de um jeito diferente.</p>
    <p class="intro-line" id="line3">Lembra de como passávamos horas dividindo histórias e telas?</p>
    <p class="intro-line" id="line4">Uma pergunta simples mudou tudo...</p>
    <button id="start-fragment-btn" onclick="startFragment()">Iniciar Fragmento</button>
</div>

<div id="background-container"></div>

<div class="main-content" id="ui">
    <h1>O que conecta tudo isso?</h1>
    <div class="input-group">
        <input type="text" id="answer" placeholder="Sua resposta..." autocomplete="off">
        <button class="check-btn" onclick="check()">Confirmar</button>
    </div>
    <div id="feedback">Incorreto. Tente novamente.</div>
</div>

<div id="final-sequence">
    <p class="final-text" id="final-text">Foi essa frase que iniciou tudo isso.</p>

    <div class="digit-container" id="digit-box">
        <span class="unlock-label">Dígito revelado</span>
        <span class="the-number">3</span>

        <button id="next-btn" onclick="goNext()">Seguir para o próximo enigma</button>
    </div>
</div>

<script>
    // --- LÓGICA DA INTRODUÇÃO ---
    const lines = [
        { id: 'line1', duration: 4000 },
        { id: 'line2', duration: 4000 },
        { id: 'line3', duration: 4500 },
        { id: 'line4', duration: 4000 }
    ];

    let currentTime = 500;

    // Sequência de textos
    window.onload = () => {
        lines.forEach((step, index) => {
            // Aparece
            setTimeout(() => {
                document.getElementById(step.id).style.opacity = "1";
            }, currentTime);

            // Desaparece (se não for a última)
            if (index < lines.length - 1) {
                setTimeout(() => {
                    document.getElementById(step.id).style.opacity = "0";
                }, currentTime + step.duration - 1000);
            } else {
                // Se for a última, some o texto e mostra o botão
                setTimeout(() => {
                    document.getElementById(step.id).style.opacity = "0";
                    setTimeout(() => {
                        const btn = document.getElementById('start-fragment-btn');
                        btn.style.display = "block";
                        setTimeout(() => btn.style.opacity = "1", 100);
                    }, 1000);
                }, currentTime + step.duration);
            }
            currentTime += step.duration;
        });
    };

    function startFragment() {
        const intro = document.getElementById('intro-overlay');
        const bg = document.getElementById('background-container');
        const ui = document.getElementById('ui');

        intro.style.transition = "opacity 1.5s";
        intro.style.opacity = "0";

        setTimeout(() => {
            intro.style.display = "none";
            bg.style.opacity = "1";
            ui.style.opacity = "1";
            ui.style.pointerEvents = "auto";
        }, 1500);
    }

    // --- LÓGICA DO ENIGMA ---
    const validAnswers = [
        "bora assistir juntos",
        "bora assistir juntos?",
        "bora ler juntos",
        "bora ler juntos?",
        "vamos assistir juntos", 
        "vamos ler juntos"
    ];

    const input = document.getElementById("answer");
    const feedback = document.getElementById("feedback");
    const successSound = document.getElementById("success-sound");

    function check() {
        const value = input.value.trim().toLowerCase();

        if (validAnswers.includes(value)) {
            success();
        } else {
            // Erro Visual (Tremida)
            feedback.style.opacity = 1;
            document.getElementById("ui").style.transform = "translateX(5px)";
            setTimeout(() => document.getElementById("ui").style.transform = "translateX(-5px)", 80);
            setTimeout(() => document.getElementById("ui").style.transform = "translateX(0)", 160);
        }
    }

    function success() {
        // Toca o som de acerto
        successSound.play().catch(e => console.log("Erro som:", e));

        // Salva progresso
        localStorage.setItem("enigma2_resolvido", "true");
        localStorage.setItem("digito_enigma2", "3");

        const ui = document.getElementById("ui");
        ui.style.opacity = 0;
        ui.style.pointerEvents = "none";
        document.body.classList.add("final-state");

        setTimeout(() => {
            ui.style.display = "none";
            document.getElementById("final-text").style.opacity = 1;
        }, 1000);

        setTimeout(() => {
            document.getElementById("digit-box").style.opacity = 1;
            document.getElementById("next-btn").style.opacity = 1;
        }, 3000);
    }

    function goNext() {
        window.location.href = "enigma4.html";
    }

    input.addEventListener("keydown", e => {
        if (e.key === "Enter") check();
    });
</script>

</body>
</html>
