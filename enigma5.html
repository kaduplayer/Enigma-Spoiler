<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Enigma 5 - A Mesa de Henrique</title>
    <link href="https://fonts.googleapis.com/css2?family=Indie+Flower&family=Bangers&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        
        body {
            /* Fundo de mesa de madeira mais escura e rica */
            background: linear-gradient(rgba(0,0,0,0.6), rgba(0,0,0,0.6)), url('https://www.transparenttextures.com/patterns/wood-pattern.png'), #2c1b18;
            background-blend-mode: overlay, multiply, normal;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            font-family: 'Indie Flower', cursive;
            perspective: 1200px; /* Perspectiva um pouco mais forte */
        }

        /* Container para o efeito de zoom e objetos da mesa */
        #table-container {
            position: relative;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: transform 1.8s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            /* Visão distante padrão */
            transform: scale(0.8) rotateX(15deg) translateY(30px);
            transform-style: preserve-3d;
        }

        /* Modo escrita (Zoom) */
        #table-container.writing-mode {
            transform: scale(1) rotateX(0deg) translateY(0);
        }

        /* --- OBJETOS DA MESA --- */
        
        /* CANETA (Lado Direito) */
        .pen {
            position: absolute;
            top: 50%;
            right: 5%; /* Posicionada à direita do centro */
            width: 12px;
            height: 160px;
            background: linear-gradient(to right, #222, #444, #222); /* Corpo escuro */
            border-radius: 4px 4px 15px 15px;
            transform: translateY(-50%) rotate(8deg) translateZ(10px); /* Levemente inclinada e elevada */
            box-shadow: 8px 8px 15px rgba(0,0,0,0.6);
            z-index: 5;
        }
        /* Ponta da caneta */
        .pen::after {
            content: ''; position: absolute; bottom: -12px; left: 1px;
            border-left: 5px solid transparent; border-right: 5px solid transparent;
            border-top: 12px solid #111;
        }

        /* ORIGAMI DE BORBOLETA (Canto Superior Esquerdo) */
        .origami-butterfly {
            position: absolute;
            top: 15%; /* Posição vertical relativa ao container */
            left: 12%; /* Posição horizontal relativa ao container */
            width: 70px; height: 60px;
            z-index: 20; /* Fica acima do caderno */
            transform: rotate(-25deg) translateZ(15px);
            filter: drop-shadow(5px 5px 5px rgba(0,0,0,0.5));
        }

        /* Asa Esquerda (Amarela/Laranjada com textura de lápis) */
        .wing-left {
            position: absolute; top: 0; left: 0; width: 0; height: 0;
            border-left: 35px solid transparent; border-right: 10px solid transparent;
            border-bottom: 60px solid #ffca28; /* Cor base */
            transform: rotate(-10deg); origin: bottom right;
            /* Simulação de textura de lápis de cor usando gradientes radiais */
            background-image: repeating-radial-gradient(circle at 50% 50%, transparent 0, rgba(255,87,34,0.2) 2px, transparent 4px);
            background-size: 10px 10px;
            clip-path: polygon(0 100%, 50% 0, 100% 100%); /* Recorta no formato do triângulo */
        }

        /* Asa Direita (Azul com textura de lápis) */
        .wing-right {
            position: absolute; top: 10px; left: 25px; width: 0; height: 0;
            border-left: 10px solid transparent; border-right: 35px solid transparent;
            border-bottom: 50px solid #42a5f5; /* Cor base */
            transform: rotate(15deg); origin: bottom left;
            /* Simulação de textura de lápis de cor */
            background-image: repeating-radial-gradient(circle at 50% 50%, transparent 0, rgba(13,71,161,0.2) 2px, transparent 4px);
            background-size: 8px 8px;
            clip-path: polygon(0 100%, 50% 0, 100% 100%);
        }

        /* --- O CADERNO --- */
        #notebook {
            width: 90%; max-width: 480px; height: 75vh;
            background: #fdf5e6;
            /* Textura de papel envelhecido e brochura */
            background-image: linear-gradient(to right, rgba(0,0,0,0.05) 0%, rgba(0,0,0,0.02) 5%, rgba(0,0,0,0.02) 95%, rgba(0,0,0,0.05) 100%), radial-gradient(#c0b0a0 1px, transparent 1px);
            background-size: 100% 100%, 25px 25px;
            box-shadow: 0 25px 40px rgba(0,0,0,0.7), inset 0 0 60px rgba(139,69,19,0.1);
            border-radius: 10px 20px 20px 10px;
            padding: 50px 40px 150px 40px;
            position: relative;
            overflow-y: auto; scrollbar-width: none;
            transform: translateZ(5px); /* Levemente elevado da mesa */
        }
        #notebook::-webkit-scrollbar { display: none; }

        #paper-content {
            color: #3e2723; font-size: 1.25rem; line-height: 1.7; white-space: pre-wrap;
            text-shadow: 1px 1px 1px rgba(0,0,0,0.1);
        }

        .title {
            font-weight: bold; font-size: 1.5rem; text-align: center; margin-bottom: 35px;
            display: block; color: #2c1b18; border-bottom: 2px dashed rgba(44,27,24,0.3); padding-bottom: 15px;
        }

        /* --- UI (BALÕES) --- */
        .ui-layer {
            position: fixed; bottom: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none; z-index: 100; display: flex; justify-content: center;
        }

        .bubble-container {
            position: absolute; bottom: 85px; width: 100%; max-width: 500px;
            display: flex; flex-direction: column; align-items: center;
        }

        .bubble {
            background: #fff; color: #000; border: 3px solid #000; border-radius: 25px;
            padding: 18px; width: 85%; font-family: 'Space Mono', monospace;
            font-size: 0.95rem; font-weight: 700; position: relative;
            box-shadow: 6px 6px 0 rgba(0,0,0,0.8); margin-bottom: 20px;
            pointer-events: all; display: none;
            animation: pop 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .bubble::after {
            content: ''; position: absolute; bottom: -18px; left: 35px;
            border-width: 18px 18px 0; border-style: solid; border-color: #000 transparent;
        }
        @keyframes pop { from { transform: scale(0.8) translateY(30px); opacity: 0; } to { transform: scale(1) translateY(0); opacity: 1; } }

        /* --- INTERAÇÕES --- */
        .options {
            display: flex; flex-wrap: wrap; gap: 12px; justify-content: center;
            pointer-events: all; width: 92%;
        }
        .btn-opt {
            background: #fff; color: #000; border: 2px solid #000; padding: 14px 18px;
            font-family: 'Bangers', cursive; font-size: 1.15rem; letter-spacing: 1.2px;
            cursor: pointer; box-shadow: 5px 5px 0 rgba(0,0,0,0.8); transition: 0.2s;
            flex: 1 1 auto; text-align: center; border-radius: 8px;
        }
        .btn-opt:active { transform: translate(3px, 3px); box-shadow: 2px 2px 0 rgba(0,0,0,0.8); }

        #name-input-area {
            display: none; margin-top: 15px; pointer-events: all; background: #fff;
            padding: 8px; border: 2px solid #000; box-shadow: 5px 5px 0 rgba(0,0,0,0.8);
            border-radius: 8px;
        }
        input {
            border: none; padding: 10px; font-family: 'Space Mono'; outline: none;
            font-weight: bold; font-size: 1.1rem; background: transparent;
        }
    </style>
</head>
<body>

    <div id="table-container">
        
        <div class="origami-butterfly">
            <div class="wing-left"></div>
            <div class="wing-right"></div>
        </div>
        <div class="pen"></div>

        <div id="notebook">
            <div id="paper-content"></div>
        </div>
    </div>

    <div class="ui-layer">
        <div class="bubble-container">
            <div id="henrique-bubble" class="bubble"></div>
            <div id="interaction-area" class="options"></div>
            
            <div id="name-input-area">
                <input type="text" id="larissa-name" placeholder="Digite seu nome..." autocomplete="off">
                <button class="btn-opt" onclick="submitName()" style="box-shadow: none; border: none; border-left: 2px solid #000; border-radius: 0;">Enviar</button>
            </div>
        </div>
    </div>

    <script>
        const paper = document.getElementById('paper-content');
        const bubble = document.getElementById('henrique-bubble');
        const interaction = document.getElementById('interaction-area');
        const nameArea = document.getElementById('name-input-area');
        const notebook = document.getElementById('notebook');
        const tableContainer = document.getElementById('table-container');
        
        let userName = "Larissa";

        // --- FUNÇÃO DE ESCRITA COM ZOOM ---
        function typeInPaper(text, isTitle = false, callback) {
            tableContainer.classList.add('writing-mode');

            let i = 0;
            const span = document.createElement('span');
            if(isTitle) span.className = 'title';
            if(!isTitle && paper.innerHTML !== "") span.innerHTML = "<br><br>";
            paper.appendChild(span);
            
            notebook.scrollTop = notebook.scrollHeight;

            const interval = setInterval(() => {
                span.innerHTML += text.charAt(i);
                i++;
                notebook.scrollTop = notebook.scrollHeight;
                if (i >= text.length) {
                    clearInterval(interval);
                    if(callback) {
                        setTimeout(() => {
                            tableContainer.classList.remove('writing-mode');
                            setTimeout(callback, 900);
                        }, 600);
                    }
                }
            }, 50); // Velocidade da escrita
        }

        function talk(text, options = []) {
            bubble.style.display = "block";
            bubble.innerHTML = `<strong>Henrique:</strong> ${text}`;
            interaction.innerHTML = "";
            
            if(options.length > 0) {
                options.forEach(opt => {
                    const btn = document.createElement('button');
                    btn.className = "btn-opt";
                    btn.innerText = opt.label;
                    btn.onclick = () => {
                        bubble.style.display = "none";
                        interaction.innerHTML = "";
                        opt.action();
                    };
                    interaction.appendChild(btn);
                });
            }
        }

        // --- ATO 1: INÍCIO ---
        window.onload = () => {
            setTimeout(() => {
                typeInPaper("Alice e Henrique — Uma amizade improvável em Harvard (por Henrique)", true, () => {
                    talk("Espera... tem alguém aí? Eu... eu não esperava visitas agora. Quem é você? Como você entrou aqui?", [
                        { label: "Responder...", action: () => { nameArea.style.display = "flex"; } }
                    ]);
                });
            }, 1000);
        };

        function submitName() {
            const inputVal = document.getElementById('larissa-name').value;
            userName = inputVal.trim() !== "" ? inputVal : "Larissa";
            nameArea.style.display = "none";
            talk(`${userName}? Que engraçado, você me lembra muito a Alice...`, [
                { label: "Alice? Quem é essa?", action: introAlice },
                { label: "Cadê o dígito?", action: responderDigito },
                { label: "Esperar em silêncio...", action: introSilencio }
            ]);
        }

        function responderDigito() {
            talk("Que dígito? Não sei de nenhum. Só sei que este sistema guarda memórias.", [
                { label: "Quem é Alice?", action: introAlice },
                { label: "Esperar em silêncio...", action: introSilencio }
            ]);
        }

        function introSilencio() {
            talk("Você se parece mesmo com ela, acho que posso confiar em você então... Quer acompanhar a história?", [
                { label: "Sim, quero acompanhar!", action: comecarHistoria },
                { label: "Não, eu não quero saber...", action: forcarHistoria }
            ]);
        }

        function introAlice() {
            talk("Alice é a minha melhor amiga, ia escrever agora a nossa história da nossa amizade. Quer acompanhar?", [
                { label: "Sim, quero acompanhar!", action: comecarHistoria },
                { label: "Não, eu não quero saber...", action: forcarHistoria }
            ]);
        }

        function forcarHistoria() {
            talk("Não quer?? Vai acompanhar sim!", [
                { label: "Tá bom...", action: comecarHistoria }
            ]);
        }

        // --- ATO 3 & 5: A HISTÓRIA NO CADERNO ---
        function comecarHistoria() {
            const texto1 = "Bom, como eu ia dizendo...\n\nHenrique (eu), sou uma pessoa bem introvertida e tímida, prefiro observar e ouvir do que falar. Até que sou inteligente, para algumas coisas, mas absurdamente inteligente, com certeza não. Me considero bem compreensível, sempre escuto as pessoas.\n\nApesar disso, eu sempre me senti perdido, não sabia ao certo o que fazer, sempre tento chegar em uma resposta, porém, nunca dá certo. Até que chega uma oportunidade de um curso em Harvard, chamado 'Projeto de Vida', ele prometia ajudar as pessoas a se encontrarem... Então decidi me inscrever.\n\nUns dias antes, em um final de semana, vou na casa de Giovanna (minha prima) e de seu futuro esposo...";
            
            typeInPaper(texto1, false, () => {
                talk("...", [
                    { label: "Tá, mas cadê a Alice nessa história?", action: reagirAlice },
                    { label: "E você achou a resposta nesse curso?", action: reagirResposta }
                ]);
            });
        }

        function reagirAlice() {
            talk("Meu Deus, calma. Ela já vai aparecer. Você parece mesmo ela...", [
                { label: "Continua...", action: historiaAlice }
            ]);
        }

        function reagirResposta() {
            talk(`Está pulando etapas, ${userName}. Mas eu diria que não exatamente, você vai me entender. Posso continuar?`, [
                { label: "Tá bom, continua.", action: historiaAlice }
            ]);
        }

        function historiaAlice() {
            const texto2 = "Nesse jantar acabo comentando com o Lúcio que eu iria fazer um curso em Harvard. Ele perguntou qual curso era, eu falo 'Projeto de Vida', e então ele fala que achava que era o mesmo curso que Giovanna faria.\n\nEntão mais tarde daquele noite, Giovanna decide ligar para Alice, chamando ela para fazer o curso. As duas conversam, e pelo o que parece, Alice iria fazer esse curso também...\n\nAlice era uma pessoa 'energética', ligada no 220, ela iluminava o ambiente que estava. Ela é extrovertida, sempre com um olhar curioso. Amava Medicina em Harvard. Outra paixão eram os livros e as séries. Completamente o oposto de mim. Alice ia atrás, Henrique nem tanto.";
            
            typeInPaper(texto2, false, () => {
                talk("...", [
                    { label: "Ligada no 220v? Achava ela cansativa?", action: reagir220 },
                    { label: "Realmente, são bem diferentes...", action: reagirDiferente },
                    { label: "E por que você não ia atrás também?", action: reagirMedo }
                ]);
            });
        }

        function reagir220() {
            talk("Nãooo! Não mesmo! É um elogio, o jeito dela cativava, muito diferente do meu.", [
                { label: "Ah bom, achei que estava falando mal.", action: () => talk("Nunca! Longe de mim isso. Vou continuar.") },
                { label: "Quanto elogio, acho que é falso!", action: () => talk(`Meu Deus, você é igual a ela... Deixa eu continuar, ${userName}.`) }
            ]);
        }

        function reagirDiferente() {
            talk("Muito. Mas acho que era exatamente disso que eu precisava. Alguém que não tivesse medo de ir atrás, já que eu passava tempo demais pensando em como ir.", [
                { label: "Entendo... continua.", action: () => { /* Próximo Ato */ } }
            ]);
        }

        function reagirMedo() {
            talk(`Não sei muito bem. Acho que era medo da mudança. Mas a Alice e Giovanna me ajudaram muito. Você vai ver, ${userName}.`, [
                { label: "Pode continuar.", action: () => { /* Próximo Ato */ } }
            ]);
        }
    </script>
</body>
</html>
